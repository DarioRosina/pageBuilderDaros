<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Page Builder Drag & Drop</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/style.css?3">
</head>
<body>

    <!-- NAVBAR -->
    <nav class="navbar navbar-expand-lg navbar-light bg-light border-bottom sticky-top">
        <div class="container-fluid">
            <a class="navbar-brand" href="https://github.com/dariorosina" target="_blank">Page Builder <sub>(daros)</sub></a>
            <div class="ms-auto"> <!-- Wrap buttons for alignment -->
                <button class="btn btn-outline-success rounded-pill me-2" data-bs-toggle="modal" data-bs-target="#importHtmlModal">
                    <i class="bi bi-box-arrow-in-down me-1"></i>Importa
                </button>
                <button class="btn btn-outline-info rounded-pill me-2" data-bs-toggle="modal" data-bs-target="#exportHtmlModal">
                    <i class="bi bi-box-arrow-up-right me-1"></i>Esporta
                </button>
                <button class="btn btn-outline-secondary rounded-pill" id="previewButton" title="Anteprima">
                    <i class="bi bi-eye me-1"></i>Anteprima
                </button>
                <button type="button" class="btn btn-outline-secondary me-2" data-bs-toggle="modal" data-bs-target="#settingsModal">
                    <i class="bi bi-gear"></i> 
                </button>
            </div>
        </div>
    </nav>


    <div class="container-fluid main-row-container no-gutter">
        <div class="row main-row">
            <!-- SIDEBAR -->
            <div class="col-lg-3 col-md-4" id="components-sidebar">
                <h5 class="mb-3">Componenti</h5>

                <div class="row g-2"> <!-- g-2 aggiunge un piccolo gutter tra le colonne -->

                    <!-- Colonna per Titolo -->
                    <div class="col-6">
                        <div class="draggable-component rounded shadow-sm mb-3 p-3 text-center h-100" draggable="true" data-component-type="heading">
                            <i class="bi bi-type-h1 fs-4 mb-1"></i>
                            <h1 class="h5 mb-0">Titolo</h1>
                            <small class="text-muted d-block">&lt;h1&gt;</small>
                        </div>
                    </div>

                    <!-- Colonna per Paragrafo -->
                    <div class="col-6">
                        <div class="draggable-component rounded shadow-sm mb-3 p-3 text-center h-100" draggable="true" data-component-type="paragraph">
                            <i class="bi bi-paragraph fs-4 mb-1"></i>
                            <p class="mb-0">Paragrafo</p>
                            <small class="text-muted d-block">&lt;p&gt;</small>
                        </div>
                    </div>

                    <!-- Colonna per Input -->
                    <div class="col-6">
                        <div class="draggable-component rounded shadow-sm mb-3 p-3 text-center h-100" draggable="true" data-component-type="input">
                            <i class="bi bi-input-cursor-text fs-4 mb-1"></i>
                            <div>Input</div>
                            <small class="text-muted d-block">&lt;input&gt;</small>
                        </div>
                    </div>

                    <!-- Colonna per Linea Orizzontale -->
                    <div class="col-6">
                        <div class="draggable-component rounded shadow-sm mb-3 p-3 text-center h-100" draggable="true" data-component-type="horizontal-rule">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-hr" viewBox="0 0 16 16">
                                <path d="M14 8a.5.5 0 0 1-.5.5H2.5A.5.5 0 0 1 2 8a.5.5 0 0 1 .5-.5h11a.5.5 0 0 1 .5.5"/>
                            </svg>
                            <div>Linea Orizzontale</div>
                            <small class="text-muted d-block">&lt;hr&gt;</small>
                        </div>
                    </div>

                    <!-- Colonna per Link -->
                    <div class="col-6">
                        <div class="draggable-component rounded shadow-sm mb-3 p-3 text-center h-100" draggable="true" data-component-type="link">
                            <i class="bi bi-link-45deg fs-4 mb-1"></i>
                            <button type="button" class="list-group-item list-group-item-action component-button">Link</button>
                            <small class="text-muted d-block mt-1">&lt;a&gt;</small>
                        </div>
                    </div>

                    <!-- Colonna per Immagine -->
                    <div class="col-6">
                        <div class="draggable-component rounded shadow-sm mb-3 p-3 text-center h-100" draggable="true" data-component-type="image">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-image mb-1" viewBox="0 0 16 16">
                            <path d="M6.002 5.5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0"/>
                            <path d="M2.002 1a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V3a2 2 0 0 0-2-2h-12zm12 1a1 1 0 0 1 1 1v6.5l-3.777-1.947a.5.5 0 0 0-.577.093l-3.71 3.71-2.66-1.772a.5.5 0 0 0-.63.062L1.002 12V3a1 1 0 0 1 1-1h12z"/>
                            </svg>
                            <div>Immagine</div>
                            <small class="text-muted d-block">&lt;img&gt;</small>
                        </div>
                    </div>

                    <!-- Colonna per Pulsante -->
                    <div class="col-6">
                        <div class="draggable-component rounded shadow-sm mb-3 p-3 text-center h-100" draggable="true" data-component-type="button">
                            <i class="bi bi-square fs-4 mb-1"></i>
                            <div>Pulsante</div>
                            <small class="text-muted d-block mt-1">&lt;button&gt;</small>
                        </div>
                    </div>

                    <!-- Colonna per Card -->
                    <div class="col-6">
                        <div class="draggable-component rounded shadow-sm mb-3 p-3 text-center h-100" draggable="true" data-component-type="card">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-card-text mb-1" viewBox="0 0 16 16">
                            <path d="M14.5 3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-13a.5.5 0 0 1-.5-.5v-9a.5.5 0 0 1 .5-.5h13zm-13-1A1.5 1.5 0 0 0 0 3.5v9A1.5 1.5 0 0 0 1.5 14h13a1.5 1.5 0 0 0 1.5-1.5v-9A1.5 1.5 0 0 0 14.5 2h-13z"/>
                            <path d="M3 5.5a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5M3 8a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9A.5.5 0 0 1 3 8m0 2.5a.5.5 0 0 1 .5-.5h6a.5.5 0 0 1 0 1h-6a.5.5 0 0 1-.5-.5"/>
                            </svg>
                            <div>Card</div>
                            <small class="text-muted d-block">Bootstrap Card</small>
                        </div>
                    </div>

                </div> <!-- FINE Row -->

            </div><!-- FINE SIDEBAR -->

            <!-- CANVAS -->
            <div class="col-lg-9 col-md-8" id="main-content-area">
                <div id="build-canvas" class="bg-light border rounded p-4 mt-3 mt-md-0">
                <p class="text-muted text-center initial-message">Trascina i componenti qui per iniziare</p>
                </div>
            </div>
        </div>
    </div>


    <!-- Modal HTML Import -->
    <div class="modal fade" id="importHtmlModal" tabindex="-1" aria-labelledby="importHtmlModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg modal-dialog-centered">
            <div class="modal-content rounded-3 shadow">
                <div class="modal-header p-4 pb-3 border-bottom-0">
                    <h1 class="fw-bold mb-0 fs-4" id="importHtmlModalLabel">Importa</h1>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body p-4 pt-0">
                    <p>Incolla qui il codice HTML (solo il contenuto del body o del container):</p>
                    <textarea id="importHtmlCode" class="form-control rounded-3" rows="10" placeholder="<html>... o <div class='container'>..."></textarea>
                    <div id="importFeedback" class="mt-3"></div> <!-- Area for feedback -->
                </div>
                <div class="modal-footer flex-nowrap p-0">
                    <button type="button" class="btn btn-lg btn-primary fs-6 text-decoration-none col-6 m-0 rounded-0 border-end" id="importConfirmButton"><strong>Importa Contenuto</strong></button>
                    <button type="button" class="btn btn-lg btn-link fs-6 text-decoration-none col-6 m-0 rounded-0" data-bs-dismiss="modal">Annulla</button>
                </div>
            </div>
        </div>
    </div>
    

    <!-- Modal HTML Export -->
    <div class="modal fade" id="exportHtmlModal" tabindex="-1" aria-labelledby="exportHtmlModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg modal-dialog-centered">
            <div class="modal-content rounded-3 shadow">
                <div class="modal-header p-4 pb-3 border-bottom-0">
                    <h1 class="fw-bold mb-0 fs-4" id="exportHtmlModalLabel">Esporta</h1>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body p-4 pt-0">
                    <p>Copia il codice HTML generato dalla tua pagina:</p>
                    <textarea id="exportedHtmlCode" class="form-control rounded-3" rows="10" readonly></textarea>
                </div>
                <div class="modal-footer flex-nowrap p-0">
                    <button type="button" class="btn btn-lg btn-link fs-6 text-decoration-none col-6 m-0 rounded-0 border-end" id="copyHtmlButton"><strong>Copia negli appunti</strong></button>
                    <button type="button" class="btn btn-lg btn-link fs-6 text-decoration-none col-6 m-0 rounded-0" data-bs-dismiss="modal">Chiudi</button>
                </div>
            </div>
        </div>
    </div>


    <!-- Modal per Anteprima Pagina -->
    <div class="modal fade" id="previewModal" tabindex="-1" aria-labelledby="previewModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-xl modal-fullscreen-lg-down">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="previewModalLabel">Anteprima Pagina</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body p-0"> 
                    <iframe id="previewFrame" style="width: 100%; height: 75vh; border: none;"></iframe>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Chiudi Anteprima</button>
                </div>
            </div>
        </div>
    </div>


    <!-- Modal Impostazioni Pagina -->
    <div class="modal fade" id="settingsModal" tabindex="-1" aria-labelledby="settingsModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="settingsModalLabel">Impostazioni Pagina</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="settingsForm">
                        <div class="mb-3">
                            <label for="columnCountInput" class="form-label">Numero di Colonne Layout:</label>
                            <input type="number" class="form-control" id="columnCountInput" value="3" min="1" max="12" required>
                            <div class="form-text">Imposta il numero di colonne per la griglia principale.</div>
                        </div>
                        <div id="settingsFeedback" class="mt-3"></div> <!-- Area per feedback -->
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Annulla</button>
                    <button type="button" class="btn btn-primary" id="saveSettingsButton">Salva Impostazioni</button>
                </div>
            </div>
        </div>
    </div>


    <!-- Modal per Cambiare Livello Heading -->
    <div class="modal fade" id="headingLevelModal" tabindex="-1" aria-labelledby="headingLevelModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-sm">
        <div class="modal-content">
            <div class="modal-header">
            <h5 class="modal-title" id="headingLevelModalLabel">Cambia Livello Titolo</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
            <label for="headingLevelSelect" class="form-label">Seleziona nuovo livello:</label>
            <select class="form-select" id="headingLevelSelect">
                <option value="1">H1</option>
                <option value="2">H2</option>
                <option value="3">H3</option>
                <option value="4">H4</option>
                <option value="5">H5</option>
                <option value="6">H6</option>
            </select>
            </div>
            <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Annulla</button>
            <button type="button" class="btn btn-primary" id="saveHeadingLevelButton">Salva Modifiche</button>
            </div>
        </div>
        </div>
    </div>


    <!-- Modal per Cambiare Tipo Input -->
    <div class="modal fade" id="inputAttributesModal" tabindex="-1" aria-labelledby="inputAttributesModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-sm">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="inputAttributesModalLabel">Modifica Tipo Input</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <label for="inputTypeSelect" class="form-label">Seleziona nuovo tipo:</label>
                    <select class="form-select" id="inputTypeSelect">
                        <option value="text">Text</option>
                        <option value="password">Password</option>
                        <option value="email">Email</option>
                        <option value="number">Number</option>
                        <option value="tel">Telephone (tel)</option>
                        <option value="url">URL</option>
                        <option value="search">Search</option>
                        <option value="date">Date</option>
                        <option value="time">Time</option>
                        <option value="datetime-local">Date & Time (local)</option>
                        <option value="month">Month</option>
                        <option value="week">Week</option>
                        <option value="color">Color</option>
                        <option value="file">File</option>
                        <!-- Aggiungi altri tipi se necessario -->
                    </select>
                    <!-- Potresti aggiungere altri campi qui, es. per pattern, min, max, step -->
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Annulla</button>
                    <button type="button" class="btn btn-primary" id="saveInputTypeButton">Salva Modifiche</button>
                </div>
            </div>
        </div>
    </div>


    <!-- Modal per Linea Orizzontale -->
    <div class="modal fade" id="hrAttributesModal" tabindex="-1" aria-labelledby="hrAttributesModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-sm">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="hrAttributesModalLabel">Modifica HR</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="mb-3">
                        <label for="hrHeightInput" class="form-label">Altezza (px)</label>
                        <input type="number" class="form-control" id="hrHeightInput" placeholder="es. 1 (lascia vuoto per default)" min="0">
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Annulla</button>
                    <button type="button" class="btn btn-primary" id="saveHrAttributesButton">Salva Modifiche</button>
                </div>
            </div>
        </div>
    </div>


    <!-- Modal per Cambiare URL Link -->
    <div class="modal fade" id="linkHrefModal" tabindex="-1" aria-labelledby="linkHrefModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="linkHrefModalLabel">Modifica Link</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
            <div class="modal-body">
                <div class="mb-3">
                    <label for="linkHrefInput" class="form-label">URL (href)</label>
                    <input type="url" class="form-control" id="linkHrefInput" placeholder="https://esempio.com o #">
                </div>
                <div class="mb-3">
                    <label for="linkTargetSelect" class="form-label">Target (dove aprire il link)</label>
                    <select class="form-select" id="linkTargetSelect">
                        <option value="">Stessa finestra (_self - default)</option>
                        <option value="_blank">Nuova finestra/tab (_blank)</option>
                        <option value="_parent">Frame genitore (_parent)</option>
                        <option value="_top">Finestra intera (_top)</option>
                    </select>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Annulla</button>
                <button type="button" class="btn btn-primary" id="saveLinkHrefButton">Salva Modifiche</button>
            </div>
            </div>
        </div>
    </div>


    <!-- Modal per Cambiare Attributi Immagine -->
    <div class="modal fade" id="imageAttributesModal" tabindex="-1" aria-labelledby="imageAttributesModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="imageAttributesModalLabel">Modifica Attributi Immagine</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="mb-3">
                    <label for="imageSrcInput" class="form-label">URL Immagine (src)</label>
                    <input type="url" class="form-control" id="imageSrcInput" placeholder="https://esempio.com/immagine.jpg">
                    </div>
                    <div class="row">
                    <div class="col">
                        <label for="imageWidthInput" class="form-label">Larghezza (px)</label>
                        <input type="number" class="form-control" id="imageWidthInput" placeholder="es. 150 (lascia vuoto per auto)">
                    </div>
                    <div class="col">
                        <label for="imageHeightInput" class="form-label">Altezza (px)</label>
                        <input type="number" class="form-control" id="imageHeightInput" placeholder="es. 100 (lascia vuoto per auto)">
                    </div>
                    </div>
                    <div id="imagePreview" class="mt-3 text-center" style="min-height: 50px;">
                        <small>Anteprima apparirà qui se l'URL è valido.</small>
                    </div>
                    <div id="imageError" class="alert alert-danger mt-2 d-none" role="alert">
                    URL immagine non valido o non caricabile.
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Annulla</button>
                    <button type="button" class="btn btn-primary" id="saveImageAttributesButton">Salva Modifiche</button>
                </div>
            </div>
        </div>
    </div>


    <!-- Modal Conferma Eliminazione -->
    <div class="modal fade" id="deleteConfirmModal" tabindex="-1" aria-labelledby="deleteConfirmModalLabel" aria-hidden="true" data-bs-backdrop="static" data-bs-keyboard="false"> <!-- Static backdrop -->
        <div class="modal-dialog modal-sm modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="deleteConfirmModalLabel">Conferma Eliminazione</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    Sei sicuro di voler eliminare questo elemento? L'azione non può essere annullata.
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Annulla</button>
                    <button type="button" class="btn btn-danger" id="confirmDeleteButton">Elimina</button>
                </div>
            </div>
        </div>
    </div>


    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

    <script src="js/domRefs.js?48"></script>
    <script src="js/handlersElements.js?48"></script>
    <script src="js/handlersControls.js?48"></script>
    <script src="js/handlersSettings.js?48"></script>
    <script src="js/handlersDragDrop.js?48"></script>
    <script src="js/promptsElements.js"></script>
    <script src="js/canvas.js?48"></script>
    <script src="js/elementsFactory.js?48"></script>
    <script src="js/htmlParser.js?48"></script>
    <script src="js/htmlImport.js?48"></script>
    <script src="js/htmlExport.js?49"></script>
    <script src="js/htmlPreview.js?48"></script>
    <script src="js/listeners.js?48"></script>

    <script>
        checkCanvasEmpty(); // Controlla lo stato iniziale del canvas
    </script>

</body>
</html>
